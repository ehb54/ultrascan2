<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
	<title>SOMO SAXS/SANS Simulation Module</title>
	<link href="mainstyle.css" rel="styleSheet" type="text/css">
</head>
<body>
<table BORDER=0 CELLPADDING=5 >
<tr>
<td><img SRC="ultrascan1.png" BORDER="0" ALT="UltraScan Version"> </td>
<td>
<center>
<h1>
<i>Manual</i></h1></center>
</td>
</tr>
</table>

<hr>
<center>
<h2>
SOMO - SAXS/SANS Simulation Module:</h2>
<p>
<p>
<h3><center>Last updated: March 2012 </center></h3><p>
<p>
<img SRC="somo-SAXS_SANS.png" ALT="SOMO SAXS Simulation Screen">
</center>
<p>
Small-Angle X-ray or Neutron Scattering (SAXS or SANS) <i>I(q)</i> vs. <i>q</i> curves, and pairwise distance distribution
curves <i>P(r)</i> vs. <i>r</i>, can be generated by this  module from either a PDB file or a bead model. The module is still under development, but several features are already (March 2012) available.<p>
The module window is accessed from the <b>US-SOMO</b> main window by pressing the <b><i>SAXS/SANS Functions</i></b> button. If either a PDB or a bead model file are loaded in the <b>US-SOMO</b> main window, it will be automatically exported to the <b>SAXS/SANS module</b>, and listed in the <i>PDB Filename</i> (alternatively, <i>Bead Model Filename</i>) field. If no files were selected in the main <b>US-SOMO</b> window, this field will be empty.<p>
In order to properly compute the  <i>I(q)</i> vs. <i>q</i> and <i>P(r)</i> vs. <i>r</i> curves, the module utilizes the  <a href=
"somo-2.png">atom definition</a> (default: <i>somo.atom</i>), <a href="somo-hybrid.png">hybridization</a> (default: <i>somo.hybrid</i>) and <a href="somo-saxs_coeff1.png">SAXS coefficients</a> (default: <I>somo.saxs_atoms</i>) tables. Different tables can be selected by pressing the <b><i>Load Atom Definition File</i></b>, <b><i>Load Hybridization File</i></b>, and <b><i>Load SAXS Coefficients File</i></b> buttons. See the <a href="somo.html">main help</a> for further explanations on the content and use of these tables.<p>

The <b>SAXS/SANS module</b> panel is divided in two sections, <b><i>SAXS/SANS I(q) Plotting Functions:</i></b> and <b><i>P(r) vs. r Plotting Functions:</i></b>, which can operate indipendently, each one with its graphicss window. <p>
<hr>
<center>

<p>
<img SRC="somo-SAXS_SANS_Iq_panel.png" ALT="SOMO SAXS I(q) Simulation Panel">
</center>
<p>

<b><i>SAXS/SANS Plotting Functions:</i></b>
The first box in this section provides the user with a choice between several methods for the computation of the <i>I(q)</i> vs. <i>q</i> curves for either SAXS or SANS (via mutually exclusive checkboxes).<p>
For SAXS, the choice is between:
<ul>
<li>
<b><i>Full</i></b>. Full Debye method, utilizing the following equations:<p>

<img SRC="Debye_eq1.png" ALT="Debye for SAXS">
<p>
with<p>
<img SRC="Debye_eq2.png" ALT="Debye for SAXS">
<p>
where <i>c<sup>(i)</sup></i>, <i>a<sub>k</sub><sup>(i)</sup></i> and <i>b<sub>k</sub><sup>(i)</sup></i> are the X-ray scattering atomic coefficients of non-hydrogen atom <i>i</i>, taken from the <a href="somo-saxs_coeff1.png">SAXS coefficients</a> table, <i>count<sup>(i)</sup><sub>hydrogen</sub></i> is the number of hydrogens attached to atom <i>i</i>, deduced from the  <a href="somo-2.png">atom definition</a> table, <i>c<sup>(hydrogen)</sup></i>, <i>a<sub>k</sub><sup>(hydrogen)</sup></i> and <i>b<sub>k</sub><sup>(hydrogen)</sup></i> are the X-ray scattering atomic coefficients of hydrogen atoms, <i>v<sup>(i)</sup><sub>excluded</sub></i> is the excluded volume of the atomic group <i>i</i> (non-hydrogen atom + attached hydrogen(s)), taken from the  <a href="somo-2.png">atom definition</a> table, &rho; is the solvent electron density, as entered in the <a href=somo_saxs_options.html>SAXS/SANS Options</a> panel, <i>q<sub>j</sub></i> is the scattering vector at which the computation is performed, and <i>r<sub>i,k</sub></i> is the distance between the centers of atoms <i>i</i> and <i>k</i>.

<li>
<b><i>H3</i></b>. Hybrid Debye method. This is an implementation of the Debye method that runs faster than the full Debye method, at the cost of some accuracy. A manuscript describing it is in preparation (Brookes, 2012).<p>
<h3><b>WARNING: Full and Hybrid Debye methods require explicit hydration!</b></h3> We are still refining our hydration method, which is currently (March 2012) not yet made available to the <b><i>US-SOMO</i></b> users. If you hydrate your structure using one of the methods in the public domain, or your own method, please rename the water residues as "SWH". In this way, the <b><i>US-SOMO</i></b> <i>I(q)</i> vs. <i>q</i> Full and Hybrid Debye methods will be able to account for them in the computations.<p>
<li>
<b><i>Fast</i></b>. This is an internal implementation of the FoXS method (see below).<p>

<li>
<b><i>FoXS</i></b>. This will externally call a pre-compiled version of the method described in Schneidman-Duhovny, Hammel and Sali, "FoXS: a web server for rapid computation and fitting of SAXS profiles", Nucl. Acids Res. 38:W540-W544, 2010. Presently, no options can be set for FoXS, which is then unable to perform parametric fitting to an experimental curve. <b>Important: FoXS is currently available in the US-SOMO Linux version only!</b><p>

<li>
<b><i>Crysol</i></b>. This will externally call the popular program Crysol (Svergun, Barberato, and Koch. J. Appl. Cryst. 28:768-773, 1995), whose main options can be set in the <a href=somo_saxs_options.html> SAXS/SANS Options submenu</a>. Currently (March 2012) the parametric fit to an experimental curve capability of Crysol has not yet been implemented within <b>US-SOMO</b>.<p>
</ul>

For SANS no <i>I(q)</i> vs. <i>q</i> computation methods have yet (March 2012) been implemented. The choice will be between:
<ul>
<li>
<b><i>Full</i></b>. Full Debye method.<p>

<li>
<b><i>H3</i></b>. Hybrid Debye method.<p>

<li>
<b><i>Fast</i></b>. Fast, FoXS-like method. <p>

<li>
<b><i>Crysol</i></b>. This will externally call Cryson (Svergun, Richard, Koch, Sayers, Kuprin and Zaccai. Protein hydration in solution: experimental observation by X-ray and neutron scattering. Proc. Natl. Acad. Sci. USA 95:2267-2272, 1998).<p>
</ul>
<hr>
<center>

<p>
<img SRC="somo-SAXS_SANS_Iq_panel1.png" ALT="SOMO SAXS I(q) Simulation Panel part">
</center>
<p>
When a method is selected, the right field of the <i>File suffix:</i> two fields will show an automatic extension: db for Full Debye, h3a for H3 hybrid Debye, fd for Fast, fx for FoXS, and cr_h##_g##_hs#_## for Crysol. For the latter, h## indicates the number of harmonics, g## the order of the Fibonacci grid, and hs#_## the contrast of the hydration shell. An user defined file suffix can also be added in the left field, and the content of these two fields will be appended to the PDB (or bead model) root filename. The <i>I(q)</i> vs. <i>q</i> curves generated with the Full, H3 and Fast methods will have the extension ".ssaxs" (or ".ssans"). Curves generated with FoXS will have a ".dat" extension, and those generated with Crysol/Cryson will have the ".int" extension.<p>
Before starting an <i>I(q)</i> vs. <i>q</i> computation, an experimental curve might be loaded by pressing the <b><i>Load SAXS Curve</i></b> button (the label will switch to  <b><i>Load SANS Curve</i></b> if a SANS method is selected). This will open up a panel listing previously utilized directories where the appropriate file might be found:  
<center>
<p>
<img SRC="somo-SAXS_SANS_Previous_Directories.png" ALT="SOMO SAXS I(q) Previous Directories">
</center>
<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_File_types.png" ALT="SOMO SAXS I(q) File tipes">
</center>
<p>
Once a file has been selected (see above for a list of compatible file types), the curve will be displayed in the top-right interactive graphics window:
<center>
<p>
<img SRC="somo-SAXS_SANS_SAXS_curve.png" ALT="SOMO SAXS I(q) Expt. SAXS curve example">
</center>
<p>
Pressing the <b><i>Legend</i></b> button will toggle on/off the displayed curve(s) filename(s). Portions of the graphs can be zoomed in by selecting them with the mouse while pressing the central button:
<center>
<p>
<img SRC="somo-SAXS_SANS_SAXS_curve1.png" ALT="SOMO SAXS I(q) Expt. SAXS curve zoom example">
</center>
<p>
The top horizontal and right vertical scroll bars allow the visualization of other portions of the graph at the actual zoom level. Right-clicking with the mouse on the graph will restore the full scaling of the graph. Right-clicking on the graph frame will instead open an interactive panel for setting overall graph properties (not shown). Other plotting properties, such as the <i>q</i> units (&#8491; or nm), can be set in the <a href=somo_saxs_options_misc.html> SAS Miscellaneous Options</a> submenu.<p>


<hr>

The computation of the <i>I(q)</i> vs. <i>q</i> profile is started by pressing the <b><i>Compute SAXS</i></b> (alternatively, <b><i>Compute SANS</i></b>) button. If one or more curves (experimental or model) are already loaded in the graphics window, a small window will pop-up asking to select the target plotted data to set the <i>I(q)</i> grid defining the starting and ending <i>q</i> values and the stepsize over which the <i>I(q)</i> vs. <i>q</i> computations will be carried out:  
<center>
<p>
<img SRC="somo-SAXS_SANS_setgrid.png" ALT="SOMO SAXS I(q) SAXS computation set grid">
</center>
<p>
Pressing <i>Cancel</i> will set the <i>q</i> range to the one defined in the <a href=somo_saxs_options.html> SAXS/SANS Options submenu</a>. Pressing <i>OK</i>, another small window will pop-up asking to decide to either keep the whole range of <i>q</i> values, or to decimate it by dividing the number of <i>q</i> points by an integer:  
<center>
<p>
<img SRC="somo-SAXS_SANS_setgrid1.png" ALT="SOMO SAXS I(q) SAXS computation set grid-divide">
</center>
<p>
This allows avoiding long computations when the target curve contains a large number of <i>q</i> values. If a number greater than 1 is entered, on pressing <i>OK</i> the same window will report an updated number of grid points, and the operation can be repeated until a satisfactory number of points is attained (be aware that the current version of <b>Crysol</b> provided with <b>US-SOMO</b> will not use more than 200 <i>q</i> points anyway): 
<center>
<p>
<img SRC="somo-SAXS_SANS_setgrid2.png" ALT="SOMO SAXS I(q) SAXS computation set grid-divide2">
</center>
<p>
If the integer has not been changed, on pressing <i>OK</i> the computation of <i>I(q)</i> vs. <i>q</i> is finally launched, and its progress is monitored by the <i>Progress bar</i> right next to the <b><i>Compute SAXS</i></b> button, and in the progress window at the bottom of the panel.<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_cal_progress.png" ALT="SOMO SAXS I(q) SAXS computation progress">
</center>
<p>

At the end of the computation, a small window pops-up asking if the computed curve is to be rescaled on other previously loaded curves. The curve used to set the grid is proposed as the target curve:<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_Scaling_curve.png" ALT="SOMO SAXS I(q) SAXS computation scaling">
</center>
<p>
On pressing <i>OK</i>, a check is performed for the existence of a file with the same filename. If one is found, another windows pops-up:
<center>
<p>
<img SRC="somo-SAXS_SANS_overwrite.png" ALT="SOMO SAXS I(q) SAXS overwrite?">
</center>
<p>
The existing file can be replaced by pressing the <b><i>Overwrite existing file</i></b> button, or the automatically appended number at the end of the original filename (e.g. "1" before "-db" in the above example) can be augmented by one pressing the <b><i>Use next sequential integer</i></b> button. Alternatively, the filename can be modified by writing in the <i>Update the filename</i> field and then pressing the <b><i>Try again</i></b> button (if the new filename exists, the pop-up window will reappear updated).<br>
Once filenames issues have been cleared, the graphics window and the progress window are updated:<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_comp_Plotted1.png" ALT="SOMO SAXS I(q) SAXS Plotted">
</center>
<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_cal_progress1.png" ALT="SOMO SAXS I(q) SAXS Progress final">
</center>
<p>
The progress window reports several parameters of the scaling/matching operation, like fitting range, scaling factor, &chi;<sup>2</sup>, degrees of freedom (df), normalized &chi; (nchi=<span style="white-space: nowrap; font-size:larger"> &radic;</span> <span style="text-decoration:overline;">&nbsp;&chi;<sup><span style="white-space: nowrap; font-size:smaller">2</span></sup>&nbsp; / (df - 1) &nbsp;</span> ), the average fractional standard deviation of the target curve (sdf; this is obtained by first dividing the experimental SD at each <i>q</i> point by the experimental <i>I(q)</i> signal at that point, and then making the average), and the product nchi*sdf. The scaling operation is performed weighting each point in the target curve by its associated error. Since data derived from modern SAS detectors can have very small associated errors, the resulting nchi can assume relatively large values even for quite good fits. The product nchi*sdf should give a better estimate of the goodness of the fit. This can be seen by comparing the different ways the residuals of the scaling operation can be represented in a pop-up window that appears at the end of the process (see below). The progress window also reports the total and unhydrated excluded volumes, and the average electron density of the model, plus that of the hydration shell if explicit water molecules are present.
Note that all fitting is done on the grid of the target curve.  Any computed curves computed with fewer points than the fitting target curve are interpolated using cubic splines to the experimental curve before fitting.
<center>
<p>
<img SRC="somo-SAXS_SANS_residuals1.png" ALT="SOMO SAXS I(q) Computed SAXS residuals 1">
</center>
<p>
In the graph above, the difference between the calculated and the experimental <i>I(q)</i> points divided by the associated experimental SD are plotted as a funtion of <i>q</i>. The two horizontal white lines indicate the +/- 2 SD which is customarily used as limits for a good fit.<p>
Alternatively, the data can be viewed as a % delta [100 * (<i>I(q)<sub>calc</sub> - I(q)<sub>expt</sub>) / I(q)<sub>expt</sub></i>] by clicking on the <i>Plot as percent</i> checkbox:

<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_residuals3a.png" ALT="SOMO SAXS I(q) Computed SAXS residuals 3">
</center>
<p>
Here we have added two horizontal lines indicating 5% limits of the residuals. We think that this way of plotting the residuals better takes into account the wide variation in both intensity and associated SD values along the <i>q</i> range usually accessed in SAXS experiments.<p>

The same residuals can by also plotted using a log scale by clicking on the <i>Plot log</i> checkbox: 
<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_residuals2.png" ALT="SOMO SAXS I(q) Computed SAXS residuals 2">
</center>


<hr>

<p>Previously computed csv-style <i>I(q)</i> vs. <i>q</i> files, such as those generated using the <a href="somo_batch.html">US-SOMO Batch Mode</a>, can also be uploaded in the graphics window. In this case, a new window will open listing all the individual curves present in the csv file, plus all other files already uploaded into the graphics window, as described in this <a href="somo_saxs_load_csv.html">help file</a>.

After the appropriate selection, pressing "OK" will update the graphics window, and at the same time also the progress window in the bottom-left corner of the panel:
<center>
<p>
<img SRC="somo-SAXS_SANS_Plotted2.png" ALT="SOMO SAXS I(q) Expt. SAXS CSV file average SD plotted">
</center>
<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_Plotted_progress_window.png" ALT="SOMO SAXS I(q) Expt. SAXS CSV file progress window">
</center>
<p>

<hr>

<center>
<p>
<img SRC="somo-SAXS_SANS_Iq_panel.png" ALT="SOMO SAXS I(q) Simulation Panel">
</center>
<p>
Getting back to the  <b><i>SAXS/SANS I(q) Plotting Functions:</i></b> panel, pressing the  <b><i>Load Plotted</i></b> button will re-open the <a href="somo_saxs_load_csv.html"><i>Load CSV style SAXS results</i></a>  window, listing all data currently shown on the graphics window, on which further operations can be performed.<br>
More operations with multiple <i>I(q)</i> vs. <i>q</i> datasets, such as NNLS fitting or best dataset fitting to a target curve can be performed within the <a href="somo_saxs_load_csv.html"><i>Load CSV style SAXS results</i></a>  module.<br> 
Pressing the <b><i>Set Grid</i></b> button will open up a small window allowing to select, if multiple curves are present, which one is to be used to set the grid for computing an <i>I(q)</i> vs. <i>q</i> curve:
<center>
<p>
<img SRC="somo-SAXS_SANS_Set_Grid.png" ALT="SOMO SAXS I(q) Expt. SAXS CSV file average SD plotted">
</center>
<p>
Pressing the <b><i>Clear SAXS (SANS) Curve</i></b> button will sequentially remove all loaded curve(s) from the graphicss window.<br>
The <b><i>Load GNOM</i></b> button allow loading the content of a GNOM-generated file (see <a href="http://www.embl-hamburg.de/biosaxs/manual_gnom.html">http://www.embl-hamburg.de/biosaxs/manual_gnom.html</a>). This will load graphs in both the <i>I(q)</i> vs. <i>q</i> and <i>P(r)</i> vs. <i>r</i> windows.<br>
Since the <i>P(r)</i> vs. <i>r</i> can be optionally normalized by the ratio between the area under the <i>P(r)</i> curve and the molecular weight of the structure (or bead model), a value for the molecular weight must be entered when loading standard GNOM files. A pop-up window will ask to do so:
<center>
<p>
<img SRC="somo-SAXS_SANS_p_r_Set_MW.png" ALT="SOMO SAXS GNOM set MW">
</center>
<p>
The user will be then asked if she/he wants to save the entered molecular weight value in the GNOM file:
<center>
<p>
<img SRC="somo-SAXS_SANS_p_r_store_MW_gnom.png" ALT="SOMO SAXS GNOM store MW">
</center>
<p>
If the user accepts to save the molecular weight in the GNOM file, another pop-up window will appear asking to either overwrite the loaded GNOM file, or to change its filename:
<center>
<p>
<img SRC="somo-SAXS_SANS_p_r_store_MW_gnom_overwrite.png" ALT="SOMO SAXS GNOM store MW replace file">
</center>
<p>
By saving the molecular weight value in the GNOM file, <b><i>US-SOMO</i></b> will recognized it the next time the file is opened, without any further need t re-enter it.


<p>
<hr>
Two other common ways of plotting SAXS/SANS data are implemented within this module. By selecting the <i>Guinier plot</i> checkbox, the data are plotted as <i>I(q)</i> vs. <i>q<sup>2</sup></i>:<p>
<center>
<p>
<img SRC="somo-SAXS_SANS_Guinier.png" ALT="SOMO SAXS I(q) Guinier plot">
</center>
<p>
whose range can be changed by entering starting and ending <i>q<sup>2</sup></i> values in the two fields next to the <i>Guinier plot</i> checkbox.<br>

A Guinier analysis can be performed on a loaded curve by pressing the <b><i>Guinier Analysis</i></b> button. If not specified in the above two fields, the optimal range will be automatically searched by the program, and the results (<i>Rg</i>, <i>I(0)</i>, <i>q*Rg(min)</i>, <i>q*Rg(max)</i>, number of points used, and &chi;<sup>2</sup>), will be displayed in the progress window:<p> 

<p>
<center>
<img SRC="somo-SAXS_SANS_Guinier_analysis.png" ALT="SOMO SAXS I(q) Guinier analysis plot">
<img SRC="somo-SAXS_SANS_Guinier_analysis_report.png" ALT="SOMO SAXS I(q) Guinier analysis report">
</center>
<p>
Settings controlling the Guinier analysis can be changed in the <a href=somo_saxs_options.html>SAXS/SANS Options</a> panel.<br>
Besides zooming with the mouse, the <i>q</i> range of the graph can be changed by selecting the <i>Standard</i> checkbox and entering min and max values in the two fields at the right (one of the two fields can be left blank).<br>
Finally, by selecting the <i>Kratky plot</i> checkbox, the data are plotted as <i>q<sup>2</sup>*I(q)</i> vs. <i>q</i>: 
<p>
<center>
<img SRC="somo-SAXS_SANS_Kratky.png" ALT="SOMO SAXS I(q) Kratky plot">
</center>
<p>
Computed <i>I(q)</i> vs. <i>q</i> curves can be matched against experimental data also in the Kratky plot format (see also the <a href=somo_saxs_options.html>options page</a>)- 
<p>
<hr>
For research purposes, we have also implemented a best parameters search related to the <i>I(q)</i> vs. <i>q</i> computations. Pressing the <b><i>Search</i></b> button will open a new window where the search parameters can be set and the search launched (see <a href=somo_SAXS_search.html>here</a>). 
<p>
<p>
<p>
<p>
<hr><hr>
<center>

<p>
<img SRC="somo-SAXS_SANS_Pr_panel.png" ALT="SOMO SAXS P(r) Simulation  Panel">
</center>
<p>
The <i>P(r)</i> vs. <i>r</i> function can be computed in either "<b>Raw</b>", "<b>SAXS</b>", or "<b>SANS</b>" modes, as
selected using the checboxes provided. The equation used is:
<p>
<i>P(r)</i> = &Sigma;<sub><i>i</i></sub> &Sigma;<sub><i>j</i></sub> [((<i>b<sub>i</sub></i> - <i>b<sub>0i</sub></i>) * (<i>b<sub>j</sub></i> - <i>b<sub>0j</sub></i>) / <i>< (b - b<sub>0</sub>) ><sup>2</sup></i> * &delta;(<i>r</i> - <i>r<sub>ij</sub></i>)] 
<p>
with, for SAXS, <i>b<sub>0i</sub></i> = 10 * (<i>r<sub>i</sub></i> / <i>r<sub>wat</sub></i>)<sup>3</sup>
<p>
where the <i>b<sub>i</sub></i> and <i>b<sub>j</sub></i> are:<br>
1- set to "1" for the "<b>Raw</b>" computations;<br> 
2- are the number of electrons of the <i>i</i> and <i>j</i> atomic groups for the <b>SAXS</b> computations;<br>
3- are the neutron scattering lengths of the <i>i</i> and <i>j</i> atomic groups at the set D<sub>2</sub>O fraction <i>Y</i> for the <b>SANS</b> computations.<br>
For SAXS, 10 is the number of electrons in a water molecule, <i>r<sub>i</sub></i> is the radius of the <i>i<sup>th</sup></i> atom (from the <i>somo.atom</i> table) and <i>r<sub>wat</sub></i> is the radius of a bulk water molecule (as set in the <i>SAXS options</i>). The full implementation for SANS in solution is still pending (March 2012). The Kronecker's <i>delta</i> &delta;(<i>r</i> - <i>r<sub>ij</sub></i>) is applied to the distances <i>r<sub>ij</sub></i> between the atom's <i>i</i> and <i>j</i> centers for every bin <i>r</i>. The resolution is controlled by the <b>Bin size (Angstroms):</b> field (default: <b>1 A</b>). For calculations carried on the original PDB structure, the number of electrons are tabulated in the <a href="somo-hybrid.png">hybridization table</a>). For bead models, only the <b>Raw</b> option is currently (March 2012) active. In a future release, when generating a bead model the number of electrons of the atoms "assigned" to the bead will be summed up and written in the bead model file (9<sup>th</sup> column), and could then be used in the <i>P(r)</i> vs. <i>r</i> computations. Similarly, for the <b>SANS</b> computations directly on a PDB structure, the neutron scattering lengths are computed at the set D<sub>2</sub>O fraction <i>Y</i> (<i>b(Y)<sub>i</sub></i> and <i>b(Y)<sub>j</sub></i>, computed as explained <a href=somo_saxs_options.html> here</a>), and the only the <b>Raw</b> option is currently (March 2012) active for bead models. In a future release, when generating a bead model the <i>b(0)</i> values and the number of exchangeable H of the atoms "assigned" to each bead will be summed up and written in the bead model file as the 10<sup>th</sup> and 11<sup>th</sup> columns, respectively. The computation of the <i>b(Y)<sub>i</sub></i> and <i>b(Y)<sub>j</sub></i> at the set D<sub>2</sub>O fraction <i>Y</i> could then be carried out for the evaluation of the SANS <i>P(r)</i> vs. <i>r</i> distribution for a bead model.<p>
<p>
<center>
<img SRC="somo-SAXS_SANS_Pr.png" ALT="SOMO SAXS P(r)">
</center>
<p>
 
By pressing the <b><i>Compute P(r) distribution</i></b> button a 3-columns file is created, containing the <i>r</i>, the non-normalized <i>P(r)</i>, and the normalized <i>P(r)</i> values, respectively. Normalization is done by first calculating the area under the <i>P(r)</i> curve and then dividing it by the molecular weight of the structure (or bead model). Each <i>P(r)</i> value is then divided by this ratio. The <b>Normalize</b> clickbox will affect which kind is then shown in the graphics window on the right side, which will automatically rescale upon adding a new graph. The files will be saved in the /somo/SAXS/ directory and will have the extension <i>sprr_r</i> for the "Raw" setting, <i>.sprr_x</i> for the SAXS setting, and <i>.sprr_n</i> for the SANS setting. In addition, a suffix containing the bin size used (<i>e.g.</i>, <i>b1</i> for bin size = 1) will be added at the end of the PDB or bead model filename. For the SANS-type files, a suffix recalling the the D<sub>2</sub>O fraction will be also added (<i>e.g.</i>, <i>D05</i> for D<sub>2</sub>O fraction = 0.5). If a file with the same filename already exist, a prompt will appear asking if it should be overwritten or not. In the latter case, the <i>P(r)</i> vs. <i>r</i> distribution will be computed and shown in the graphics window, but not saved to a new file.<p>
<p>
<center>
<img SRC="somo-SAXS_SANS_Pr_RasMol.png" ALT="SOMO SAXS P(r) RasMol distances">
</center>
<p>

Before starting a new <i>P(r)</i> vs. <i>r</i> computation, the residues contributing to  particular bin can be identified by selecting the <i>Residue contr. range (Angstrom):</i> checkbox and entering a range (min-max) in the two fields at its right. In this case, when the <i>P(r)</i> vs. <i>r</i> computation is completed, the <b><i>Display</i></b> button becomes available, and pressing it will call <b><i>RasMol</i></b> where the structure will be visualized with the residues contributing to the selected range color-coded from yellow (max contribution) to blue (min contribution). The other residues will be colored gray.<p>

The graphics window will show every new <i>P(r)</i> vs. <i>r</i> curve in a different color, without erasing curves already present. The correspondence between the colors and the files is reported in the progress window, and can be also toggled on and off below the graphics window by pressing the <b><i>Legend</i></b> button. A previously-generated, or 
experimentally-derived <i>P(r)</i> vs. <i>r</i> curve can be uploaded in the graphics window by pressing the <b><i>Load P(r) 
Distribution</i></b> button, and the graphics window can be cleared by pressing the <b><i>Clear P(r) Distribution</i></b> button.
Progress in the operations is reported in the advancement bar on the side of the  <b><i>Compute P(r) distribution</i></b> button,
and in the progress window below the buttons. <b><i>Stop</i></b> will halt the current operation, and the option panel containing
the settings controlling the operations, such as the D<sub>2</sub>O fraction (see <a href=somo_saxs_options.html> here</a>), can be directly accessed by pressing the <b><i>Open Options Panel</i></b> button.<p>


<p>


<p>
<hr>
<font face="helvetica" size="-1">
www contact: <a href="mailto:demeler@biochem.uthscsa.edu">Borries Demeler</a>
</font>
<p>
<font face="helvetica" size="-1">
This document is part of the <i><b>UltraScan</b></i> Software Documentation
distribution. <br><a href=copyright.html>Copyright &copy; notice</a>.<br><br> The latest version of this document can always be found at:
</font>
<p>
<font face="helvetica" size="-1">
<a href="http://www.ultrascan.uthscsa.edu">http://www.ultrascan.uthscsa.edu</a>
</font>
<p>
<font face="helvetica" size="-1">
Last modified on April 26, 2012
</font>
</body>
</html>
